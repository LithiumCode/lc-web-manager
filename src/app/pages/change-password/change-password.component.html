<!-- Loading -->
<div *ngIf="loading" class="card-info loading-card">
    <div class="loader"></div>
    <p>Alterando senha...</p>
</div>
<div class="form-container">
    <h2>Trocar Senha</h2>

    <form [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="form-group">
            <label for="newPassword">Nova Senha</label>
            <input id="newPassword" type="password" formControlName="newPassword"
                [class.invalid]="form.get('newPassword')?.invalid && form.get('newPassword')?.touched" />
            <div class="error"
                *ngIf="form.get('newPassword')?.errors?.['required'] && form.get('newPassword')?.touched">
                A senha é obrigatória.
            </div>
            <div class="error"
                *ngIf="form.get('newPassword')?.errors?.['minlength'] && form.get('newPassword')?.touched">
                A senha deve ter pelo menos 6 caracteres.
            </div>
        </div>

        <div class="form-group">
            <label for="confirmPassword">Confirmar Senha</label>
            <input id="confirmPassword" type="password" formControlName="confirmPassword"
                [class.invalid]="form.hasError('passwordMismatch') && form.get('confirmPassword')?.touched" />
            <div class="error" *ngIf="form.hasError('passwordMismatch') && form.get('confirmPassword')?.touched">
                As senhas não coincidem.
            </div>
        </div>

        <div *ngIf="error" class="error-message">{{ error }}</div>
        <div *ngIf="success" class="success-message">Senha atualizada com sucesso!</div>

        <div class="button-row">
            <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">Salvar Senha</button>
            <button type="button" class="btn btn-secondary" (click)="form.reset()">Cancelar</button>
        </div>
    </form>
</div>
